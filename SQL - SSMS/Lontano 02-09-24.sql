SELECT DISTINCT ContasPagar.*, Fornecedores.RazaoSocial AS RazaoSocial, ComboBox_Financeiro.Descricao AS TipoContasPagar, ComboBox_Financeiro1.Descricao AS TipoCobranca 
FROM ContasPagar INNER JOIN FiliaisAgencias ON ContasPagar.CodFilialOrigem = FiliaisAgencias.CodFilial
INNER JOIN FiliaisAgencias FiliaisAgencias1 ON ContasPagar.CodFilialPagto = FiliaisAgencias1.CodFilial 
INNER JOIN Fornecedores ON ContasPagar.CodFornecedor = Fornecedores.CodFornecedor 
INNER JOIN Moedas ON ContasPagar.CodMoeda = Moedas.CodMoeda 
INNER JOIN ComboBox_Financeiro ON ContasPagar.CodTipoContasPagar = ComboBox_Financeiro.Codigo AND ComboBox_Financeiro.NomeComboBox = 'cboTipoContasPagar' 
INNER JOIN ComboBox_Financeiro ComboBox_Financeiro1 ON ContasPagar.CodTipoCobranca = ComboBox_Financeiro1.Codigo AND ComboBox_Financeiro1.NomeComboBox = 'cboTipoCobranca' 
INNER JOIN ComboBox_Financeiro ComboBox_Financeiro2 ON ContasPagar.CodTipoDocumento = ComboBox_Financeiro2.Codigo AND ComboBox_Financeiro2.NomeComboBox = 'cboTipoDocumento' 
LEFT OUTER JOIN PlanoContasDespesa ON ContasPagar.CodTipoDespesa = PlanoContasDespesa.CodTipoDespesa
LEFT OUTER JOIN DespesasContasPagar ON DespesasContasPagar.CodContasPagar = ContasPagar.CodContasPagar
LEFT OUTER JOIN NotasFiscaisContasPagar ON ContasPagar.CodContasPagar = NotasFiscaisContasPagar.CodContasPagar 
WHERE (ContasPagar.DataVencimento BETWEEN '07/16/2024 00:00:00' AND '07/16/2024 23:59:29') AND (ContasPagar.CodFornecedor = 1106050) ORDER BY ContasPagar.DataVencimento DESC


select Situacao,* from ContasPagar where CodContasPagar IN (1959485,1959486,1959487,1959488,1959489,1959490,1959491,1959493,1959495,1959496,1959497,1959498)
select * from ContasPagar where CodContasPagar IN (1959485)
--UPDATE ContasPagar set Saldo = 0.00 where CodContasPagar  IN (1959485,1959486,1959487,1959488,1959489,1959490,1959491,1959493,1959495,1959496,1959497,1959498)

--UPDATE ContasPagar set Situacao = 'Liquidada' where CodContasPagar  IN (1959485,1959486,1959487,1959488,1959489,1959490,1959491,1959493,1959495,1959496,1959497,1959498)
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

SELECT DISTINCT ConhecimentosTransporte.Sequencial, ConhecimentosTransporte.NumConhecto, ConhecimentosTransporte.CodUF + '-' + LTRIM(STR(ConhecimentosTransporte.NumConhecto)) AS CTRC,
ConhecimentosTransporte.DataEmissao, ConhecimentosTransporte.Sequencial, Veiculos.PlacaVeiculo, ConhecimentosTransporte.SituacaoConhecto, ConhecimentosTransporte.TarifaFreteEmpresa,
ConhecimentosTransporte.TarifaFreteMotorista, ConhecimentosTransporte.ValorAdiantamento, ConhecimentosTransporte.QuantidadeSaida, ConhecimentosTransporte.CodNaturezaCarga, 
ConhecimentosTransporte.QuantidadeChegada, ConhecimentosTransporte.ValorTotalFrete, ConhecimentosTransporte.CodRota, CASE WHEN ConhecimentosTransporte.Sequencial IN (0) THEN 'X' ELSE NULL END AS Marcador,
NaturezaCarga.DescNaturezaCarga, ConhecimentosTransporte.CodigoCFOP, ConhecimentosTransporte.CodFilialComissao, ParamDespRecFilial.Titulo,  dbo.NotaFiscalCTRC(ConhecimentosTransporte.Sequencial) AS NF 
FROM ConhecimentosTransporte
INNER JOIN Rotas ON ConhecimentosTransporte.CodRota = Rotas.CodRota
INNER JOIN Cidades ON Rotas.CodCidadeOrigem = Cidades.CodCidade 
INNER JOIN Cidades Cidades1 ON Rotas.CodCidadeDestino = Cidades1.CodCidade 
LEFT OUTER JOIN Veiculos ON ConhecimentosTransporte.CodVeiculo = Veiculos.CodVeiculo 
LEFT OUTER JOIN ConhecimentosCliente ON ConhecimentosTransporte.Sequencial = ConhecimentosCliente.SequencialConhecimento
LEFT OUTER JOIN NotasFiscaisConhecimento ON ConhecimentosTransporte.Sequencial = NotasFiscaisConhecimento.SequencialConhecimento 
LEFT OUTER JOIN PedidosFrete ON ConhecimentosTransporte.CodPedidoFrete = PedidosFrete.CodPedidoFrete 
LEFT OUTER JOIN ParamDespRecFilial ON ConhecimentosTransporte.CodRegiao = ParamDespRecFilial.NumCol
LEFT OUTER JOIN OrdemEmbarque ON ConhecimentosTransporte.CodOrdemEmbarque = OrdemEmbarque.NumOrdemEmbarque
INNER JOIN Clientes cpag ON cpag.CodCliente = ConhecimentosTransporte.CodClientePagto 
INNER JOIN Clientes_Complemento ON Clientes_Complemento.CodCliente = cpag.CodCliente 
INNER JOIN NaturezaCarga ON NaturezaCarga.CodNaturezaCarga = ConhecimentosTransporte.CodNaturezaCarga
WHERE ConhecimentosTransporte.SerieConhecto = '2' AND ConhecimentosTransporte.DataEmissao BETWEEN '07/01/2024 00:00:00' AND '07/31/2024 23:59:29' AND (ConhecimentosTransporte.SituacaoConhecto <> 'Cancelado' AND ConhecimentosTransporte.SituacaoConhecto <> 'Substituído') AND Clientes_Complemento.CodClienteMatriz = 1000537 ORDER BY ConhecimentosTransporte.Sequencial

--DECLARE @aliquotaISS float set @aliquotaISS = 5		
--update ConhecimentosTransporte set 
--basecalculoicms = ValorTotalFrete,  
--AliquotaICMSFrete = @aliquotaISS, -- <== Alterar aliquota aqui e na linha de baixo tambem caso necessario 
--valoricmsfrete = (ValorTotalFrete*@aliquotaISS/100)  -- <== Alterar aliquota aqui onde multiplica pelo ValorTotalFrete e divide por 100, caso necessario 
--WHERE Sequencial in(250000081765,450000025984,450000025991,450000026005,450000026006,450000026007,450000026009,450000026014,450000026021,450000026022,450000026023,450000026025,
--450000026026,450000026027,450000026028,450000026029,450000026030,450000026031,450000026032,450000026033,450000026034,450000026035,450000026036,450000026037,
--450000026038,450000026039,450000026040,450000026041,450000026042,450000026043,450000026044,450000026045,450000026046,450000026047,450000026055,450000026058,
--450000026059,450000026060,450000026061,450000026062,450000026063,450000026064,450000026065,450000026066,450000026067,450000026068,450000026069,450000026071,
--450000026072,450000026073,450000026074,450000026075,450000026076,450000026080,450000026081,450000026082,450000026083,450000026084,450000026085,450000026086,
--450000026087,450000026088,450000026089,450000026090,450000026091,450000026092,450000026094,450000026095,450000026096,450000026097,450000026098,450000026099,
--450000026100,450000026101,450000026102,450000026103,450000026104,450000026105,450000026106,450000026107,450000026108,450000026109,450000026110,450000026111,
--450000026112,450000026113,450000026114,450000026115,450000026116,450000026117,450000026118,450000026119,450000026120,450000026121,450000026122,450000026123,
--450000026124,450000026125,450000026126,450000026127,450000026128,450000026130,450000026131,450000026132,450000026135,450000026137,450000026139,450000026141,
--450000026142,450000026143,450000026145,450000026148,450000026149,450000026150,450000026151,450000026153,450000026155,450000026157,450000026158,450000026159,
--450000026160,450000026161,450000026162,450000026163,450000026164,450000026165,450000026166,450000026167,450000026168,450000026170,450000026171,450000026172,
--450000026173,450000026177,450000026178,450000026179,450000026180,450000026181,450000026182,450000026183,450000026184,450000026185,450000026186,450000026187,
--450000026188,450000026189,450000026190,450000026191,450000026192,450000026193,450000026194,450000026195,450000026196,450000026197,450000026198,450000026199,
--450000026200,450000026201,450000026202,450000026203,450000026204,450000026205,450000026206,450000026207,450000026208,450000026209,450000026210,450000026211,
--450000026212,450000026213,450000026214,450000026215,450000026216,450000026217,450000026218,450000026219,450000026220,450000026221,450000026222,450000026223,
--450000026224,450000026225,450000026226,450000026227,450000026230,450000026231,450000026232,450000026233,450000026234,450000026235,450000026236,450000026238,
--450000026239,450000026240,450000026241,450000026242,450000026243,450000026244,450000026245,450000026246,450000026247,450000026248,450000026249,450000026250,
--450000026251,450000026252,450000026253,450000026254,450000026256,450000026258,450000026259,450000026260,450000026261,450000026262,450000026264,450000026266,
--450000026267,450000026268,450000026269,450000026271,450000026272,450000026273,450000026274,450000026275,450000026276,450000026277,450000026278,450000026279,
--450000026281,450000026282,450000026284,450000026285,450000026286,450000026287,450000026288,450000026289,450000026290,450000026291,450000026292,450000026293,
--450000026294,450000026296,450000026297,450000026298,450000026299,450000026300,450000026301,450000026304,450000026305,450000026306,450000026308,450000026310,
--450000026311,450000026312,450000026316,450000026317,450000026321,450000026322,450000026328,450000026330,450000026331,450000026332,450000026333,450000026335,
--450000026336,450000026337,450000026338,450000026343,450000026345,450000026346,450000026347,450000026350,450000026352,450000026354,450000026355,450000026357,
--450000026359,450000026360,450000026363,450000026364,450000026370,450000026374,450000026376,450000026377,450000026379,450000026380,450000026381,450000026387,
--450000026389,450000026395,450000026396,450000026397,450000026398,450000026399,450000026400,450000026402,450000026404,450000026405,450000026406,450000026407,
--450000026408,450000026410,450000026411,450000026414,450000026415,450000026416,450000026417,450000026418,450000026419,450000026420,450000026421,450000026422,
--450000026423,450000026427,450000026429,450000026430,450000026431,450000026432,450000026433,450000026438,450000026444,450000026446,450000026447,450000026449,
--450000026450,450000026451,450000026452,450000026453,450000026454,450000026455,450000026456,450000026457,450000026459,450000026460,450000026461,450000026462,
--450000026463,450000026464,450000026465,450000026466,450000026467,450000026468,450000026469,450000026470,450000026473,450000026474,450000026475,450000026478,
--450000026479,450000026480,450000026481,450000026482,450000026483,450000026484,450000026485,450000026486,450000026488,450000026489,450000026490,450000026491,
--450000026495,450000026496,450000026497,450000026498,450000026500,450000026501,450000026503,450000026504,450000026505,450000026509,450000026510,450000026514,
--450000026515,450000026516,450000026517,450000026518,450000026524,450000026525,450000026526,450000026527,450000026528,450000026530,450000026531,450000026532,
--450000026536,450000026540,450000026543,450000026544,450000026545,450000026546,450000026547,450000026548,450000026549,450000026550)





-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------


SELECT ValorNF, SeguroAverbado,* FROM ConhecimentosTransporte WHERE NumConhecto = 20686 and CodUF = 'PA' and SerieConhecto = '0' -- 11349720.00 / 5674.86
--UPDATE ConhecimentosTransporte SET ValorNF = 113497.20, SeguroAverbado = 56.74  WHERE NumConhecto = 20686 and CodUF = 'PA' and SerieConhecto = '0'


--select * FROM  where CodPrograma LIKE '%AprovacaoPedidoCompras%'

SELECT * FROM Programas where	CodPrograma ='AprovacaoPedidoCompras'
AprovacaoPedidoCompras
AprovacaoCoordenadorManutencao
AprovacaoGerenteOperacional
AprovacaoDiretorOperações