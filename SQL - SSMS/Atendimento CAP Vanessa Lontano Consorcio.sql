-- 12 CAPs a mais  criados no mesmo dia dos caps supostamentes corretos. 
-- valores corretos.
-- rateio com erro pelo jeito. 



SELECT * from Fornecedores where CodFornecedor = 1106050
SELECT * from ContratosPagar where CodContrato = 5499
SELECT CodTipoCobranca, * from ContasPagar where CodContasPagar = 1913403
SELECT * from RateioContasPagar where CodContasPagar = 1913403

SELECT COUNT(*) from ContasPagar where CodTipoCobranca = 6 and  Situacao = 'Liberada' and  CodFornecedor = 1106050 and DataVencimento BETWEEN '2024-04-01 00:00:00' and  '2024-04-22 23:59:00' 
and NumDocumento in ('20183-639', '20183-657', '20183-658', '20202-702', '20202-703', '20202-705', '20204-405', '20204-805', '20204-806', '20205-480', '20205-533', '20205-722', '20234-787,
 20234-789', '20234-799', '20237-739', '20237-740', '20237-741', '20239-638', '20239-683', '20239-684', '20241-792', '20241-793', '20241-794', '20243-680', '20243-681,
 20243-682', '20243-683', '20244-451', '20244-452', '20244-453', '20244-454', '20246-617', '20246-618', '20246-619', '20246-620', '20249-389', '20249-390', '20249-391,
 20253-681', '20253-682', '20253-683', '20254-478', '20254-925', '20254-926', '20254-927', '20254-928', '20254-929', '20254-930', '20254-931', '20254-932', '20254-933,
 20254-934', '20254-935', '20255-196', '20255-919', '20255-920', '20255-921', '20255-922', '20255-923', '20255-924', '20255-925', '20255-926', '20255-927', '20255-928,
 20255-929', '20257-804', '20257-805', '20257-806', '20258-428', '20258-584', '20258-585', '20260-484', '20276-205', '20276-538', '20276-674', '20386-456', '20386-460,
 20386-470', '20386-474', '20386-479', '20386-506', '20386-508', '20386-520', '20386-521', '20392-64', '20392-358', '20392-539', '20392-915', '20392-916', '20392-917,
 20392-918', '20392-919', '20392-920', '20392-921', '20392-922', '20392-923', '20408-878', '20408-900', '20408-901', '20408-902', '20408-903', '20408-904', '20408-905,
 20408-906', '20408-907', '20408-908', '20408-909', '20408-910', '20416-607', '20416-649', '20416-902', '20416-914', '20416-915', '20416-916', '20425-753', '20425-754,
 20425-755', '20425-756', '20425-757', '20425-758', '20433-580', '20433-581', '20433-582', '20433-583', '20433-584', '20433-585', '20436-446', '20436-566', '20436-613,
 20436-614', '20436-626', '20442-333', '20442-347', '20442-427', '20442-441', '20442-442', '20446-43', '20446-55', '20446-69', '20446-111', '20446-686', '20446-710,
 20446-713', '20446-715', '20446-716', '20446-717', '20449-135', '20449-195', '20449-280', '20452-265', '20452-360', '20452-569', '20452-571', '20452-572', '20457-680,
 20457-681', '20457-682', '20457-691', '20457-695', '20459-311', '20459-462', '20459-495', '20465-580', '20465-581', '20465-582', '20471-655', '20471-656', '20471-657,
 20471-658', '20471-659', '20505-614', '20505-615', '20505-616', '20505-617', '20505-618', '20505-619', '20505-620', '20505-621', '20505-622', '20505-623', '20505-624,
 20505-625', '20512-620', '20512-796', '20512-797', '20512-798', '20512-799', '20512-800', '20512-801', '20512-802', '20512-803', '20512-804', '20512-805', '20512-806,
 20513-347', '20513-741', '20513-742', '20513-743', '20513-744', '20513-745', '20513-746', '20513-747', '20513-748', '20513-749', '20513-750', '20513-751', '20522-689,
 20522-815', '20522-816', '20522-817', '20522-818', '20522-819', '20522-820', '20522-821', '20522-822', '20522-823', '20522-824', '20522-825', '20530-880', '20530-888,
 20530-919', '20530-920', '20530-921', '20530-922', '20530-923', '20530-924', '20530-925', '20530-926', '20530-927', '20530-928', '20578-788', '20578-819', '20578-820,
 20578-821', '20578-822', '20578-823', '20578-824', '20578-825', '20578-826', '20578-827', '20578-828', '20578-829', '20580-499', '20580-505', '20580-525', '20580-542,
 20580-544', '20580-547', '50039-106', '50039-423', '50039-453', '50039-454', '50039-457', '50039-460', '50039-461', '50039-462', '50039-463', '50039-465', '50039-470,
 50039-471', '50041-370', '50041-373', '50041-376', '50041-383', '50041-387', '50053-117', '50053-126', '50053-128', '50053-130', '50053-131', '50058-151', '50058-154,
 50058-155', '50064-15', '50064-110', '50064-116', '50071-33', '50071-100', '50071-108', '50083-118', '50083-420', '50083-424', '20178-202', '20187-455', '20188-203,
 20189-333', '20189-395', '20193-568', '20193-667', '20383-68', '20383-86', '20383-478', '20383-524', '20383-726', '20383-727', '20383-728', '20387-101', '20387-123,
 20387-187', '20387-199', '20393-481', '20393-482', '20393-483', '20393-484', '20393-485', '20393-486', '20418-125', '20418-156', '20418-161', '20418-548', '20418-750,
 20418-755', '20422-840', '20422-841', '20422-842', '20422-843', '20422-844', '20422-845', '20434-633', '20434-635', '20434-636', '20437-85', '20437-595', '20437-726,
 20437-772', '20437-782', '20437-784', '20444-692', '20444-693', '20444-694', '20444-695', '20444-696', '20444-697', '20444-698', '20444-699', '20444-700', '20444-701,
 20444-702', '20444-703', '20453-511', '20453-512', '20453-513', '20453-514', '20463-379', '20463-381', '20463-384', '20463-400', '20468-208', '20468-217', '20468-224,
 20468-239', '20510-941', '20510-951', '20510-952', '20510-953', '20630-635', '20630-636', '20630-637', '20630-638', '20630-639', '20630-640', '20640-76', '20640-89,
 20640-523', '20640-650', '20640-651', '20640-652', '20640-653', '20640-656', '20640-658', '20640-660', '20640-662', '20640-663', '50057-169', '50057-249', '50057-250,
 50057-251', '50061-45', '50061-75', '50061-148', '50061-232', '20194-588', '20194-735', '20194-779') 


 SELECT DISTINCT ContasPagar.*, Fornecedores.RazaoSocial AS RazaoSocial, ComboBox_Financeiro.Descricao AS TipoContasPagar, ComboBox_Financeiro1.Descricao AS TipoCobranca
 FROM ContasPagar 
 INNER JOIN FiliaisAgencias ON ContasPagar.CodFilialOrigem = FiliaisAgencias.CodFilial 
 INNER JOIN FiliaisAgencias FiliaisAgencias1 ON ContasPagar.CodFilialPagto = FiliaisAgencias1.CodFilial 
 INNER JOIN Fornecedores ON ContasPagar.CodFornecedor = Fornecedores.CodFornecedor
 INNER JOIN Moedas ON ContasPagar.CodMoeda = Moedas.CodMoeda 
 INNER JOIN ComboBox_Financeiro ON ContasPagar.CodTipoContasPagar = ComboBox_Financeiro.Codigo AND ComboBox_Financeiro.NomeComboBox = 'cboTipoContasPagar'
 INNER JOIN ComboBox_Financeiro ComboBox_Financeiro1 ON ContasPagar.CodTipoCobranca = ComboBox_Financeiro1.Codigo AND ComboBox_Financeiro1.NomeComboBox = 'cboTipoCobranca'
 INNER JOIN ComboBox_Financeiro ComboBox_Financeiro2 ON ContasPagar.CodTipoDocumento = ComboBox_Financeiro2.Codigo AND ComboBox_Financeiro2.NomeComboBox = 'cboTipoDocumento'
 LEFT OUTER JOIN PlanoContasDespesa ON ContasPagar.CodTipoDespesa = PlanoContasDespesa.CodTipoDespesa
 LEFT OUTER JOIN DespesasContasPagar ON DespesasContasPagar.CodContasPagar = ContasPagar.CodContasPagar 
 LEFT OUTER JOIN NotasFiscaisContasPagar ON ContasPagar.CodContasPagar = NotasFiscaisContasPagar.CodContasPagar
 WHERE (ContasPagar.DataVencimento BETWEEN '04/01/2024 00:00:00' AND '04/22/2024 23:59:29') AND (ContasPagar.CodFornecedor = 1106050) 
 AND (ContasPagar.Situacao = 'Liberada') AND (ContasPagar.CodTipoCobranca = 6)  AND NumDocumento = '50083-424' ORDER BY ContasPagar.DataCriacao DESC


 SELECT * from ContasPagar where DataCriacao BETWEEN '2024-04-19 15:23:13.000' AND '2024-04-19 15:44:07.000' --AND 

 SELECT *  FROM DespesasContasPagar WHERE (CodContasPagar = 1782736)

 SELECT (388.56 + 27.85 +278.89+106.83+52.38+26.74+0.10+
2039.17+66.26+380.31+135.56+605.99+520.80+28.76)


select * from MovimentacaoBancaria where CodMovBancaria = 1598449 
--UPDATE MovimentacaoBancaria set CodContaBancaria = 50 where CodMovBancaria = 1598449